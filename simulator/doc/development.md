# Cook Simulator Development

## The REPL

If you are going to be working with Cook Simulator a lot, or even extending it,
you're going to want to spend most of your time at the REPL rather than at the
command line interface.

[The cook.sim.repl namespace](../src/dev/cook/sim/repl.clj) exists for the sole purpose of making development easier.  When you launch a REPL, this is the namespace you'll arrive at by default.  repl.clj is in the "src/dev" source path rather than the "src/main"
source path, and you can see in [project.clj](../project.clj) that it's not even included in the default lein profile (so, for example, it won't be included in a distributable jar by default).  There's a separate profile, "dev" which includes cook.sim.repl.

cook.sim.repl imports all of the main namespaces of the project, and provides
convenience functions to facilitate doing a lot of simulation-related work quickly.
The intent is that you should be able to leave a REPL open indefinitely, and never
switch to another namespace; you can call whatever functions you want to test/use
from your home in cook.sim.repl.

The convenenience functions in cook.sim.repl do make some assumptions about things like
the locations of your configuration files and your workload files.  cook.sim.repl in general is designed more for convenience than for flexibility; but you are free to change the functions as you work!

* (reset())


## System components

* Code reloading
* Lazy conditional instantiation


## Evaluating changes to Cook Scheduler

One of the most important ways that the Simulator can be used is to test the effect of changes to Cook Scheduler.  To compare directly, you'll want to be using the same version of Simulator to run simulations against multiple versions of Scheduler.

Since Scheduler is (at least for the time being) in the same repository as Simulator, this likely means that if you plan on testing changes or extensions to the Simulator while simultaneously comparing performance across different versions of Scheduler, you'll want to check out two local copies of the Cook repository, one to run Simulator, and one to run Scheduler.

## Sharing workloads

Cook Simulator stores all of the data it uses in Datomic, but in the course of generating a workload, the details about all of the jobs in the workload also live in a file on the filesystem.  (The "generate-workload")The reason for this is that it makes it easy to examine, share, and edit specific workloads.  For example, you might have a job schedule that demonstrates a flaw in a new branch of cook... you can easily take the schedule file, send it to the developer.  He can then look at it, edit the file to zero in ont the problem, use a file diffing tool to communicate the differences, send an adjusted version back to you, and so forth.

...


## Testing strategy

The jobs generated by Cook Simulator require allocation of resources from Mesos, but they don't actually consume any resources.  For this reason, 

...

